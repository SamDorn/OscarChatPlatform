@using Microsoft.AspNetCore.Mvc.Localization
@model OscarChatPlatform.Web.Models.HomeViewModel;
@inject IViewLocalizer localizer;

@{
    ViewData["Title"] = "Home";
}
<link rel="stylesheet" href="~/css/home.css" />
<script src="~/js/chat.js"></script>
<!-- Pop-up di caricamento -->
<div class="loading-popup" id="loadingPopup">
    <div class="loading-box">
        <div class="loading-spinner"></div>
        <i class="btn-close red" style="float:right"></i>
        <p>Stiamo cercando un altro utente...</p>
    </div>
</div>
<!-- Bottone per aprire/chiudere la sidebar su mobile -->
<button class="sidebar-toggle" id="sidebarToggle">☰</button>
<!-- Sidebar -->
<div class="sidebar" id="sidebar">
    <h1 style="font-size:22px">OscarChatPlatform</h1>
    <div class="sidebar-section" id="chatsSection">
        <h4 onclick="toggleSection('chatsSection')">Chat <span>▼</span></h4>
        <ul>
            <li>Chat 1</li>
            <li>Chat 2</li>
            <li>Chat 3</li>
        </ul>
    </div>

    <div class="sidebar-section" id="usersSection">
        <h4 onclick="toggleSection('usersSection')">Utenti <span>▼</span></h4>
        <ul>
            <li>Utente 1</li>
            <li>Utente 2</li>
            <li>Utente 3</li>
        </ul>
    </div>

    <div class="sidebar-section" id="groupsSection">
        <h4 onclick="toggleSection('groupsSection')">Gruppi <span>▼</span></h4>
        <ul>
            <li>Gruppo 1</li>
            <li>Gruppo 2</li>
            <li>Gruppo 3</li>
        </ul>
    </div>

    <div class="sidebar-section" id="settingsSection">
        <h4 onclick="toggleSection('settingsSection')">Impostazioni <span>▼</span></h4>
        <ul>
            <li>Profilo</li>
            <li>Notifiche</li>
            <li>Privacy</li>
        </ul>
    </div>
</div>

<!-- Chat container -->
<div class="chat-container" id="chatContainer">
    <main class="chat-main" id="chatMain">
        <!-- Info Box -->
        <div class="info-box">
            <h3>@(Model.IsNewUser ? localizer["WelcomeMessage"] : localizer["WelcomeBackMessage"])</h3>
            <p>
                Parla con altri utenti anonimi, scopri nuovi
                argomenti di discussione, e tanto altro ancora!
            </p>
        </div>
        <div class="kpi-container">
            <div class="kpi-box">Chat attive: <span id="activeChats">@Model.ActiveChats</span></div>
            <div class="kpi-box">Utenti online: <span id="anonymousUsers">@Model.OnlineUsers</span></div>
        </div>
        <div class="chat-form">
            <button class="start-chat-btn">Inizia a chattare</button>
        </div>
    </main>
</div>

<script>
    var toggled = false;
        // Funzione per aprire/chiudere le sezioni della sidebar
    function toggleSection(sectionId) {
        const section = document.getElementById(sectionId);
        section.classList.toggle('active');
    }

    $("#sidebarToggle").on("click", function(){
        if(toggled){
            $("#sidebar").removeClass("active");
            toggled = false;
        }
        else{
            toggled = true;
            $("#sidebar").addClass("active");
        }

    });
</script>